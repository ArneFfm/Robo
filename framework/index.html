<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://robo.li/framework/">
        <link rel="shortcut icon" href="../../img/favicon.png">
        
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>

	<title>Robo as Framework - Robo</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="..//css/robo.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">Robo</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Index</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Guides <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../getting-started/">Getting Started</a>
</li>

                        
                            
<li >
    <a href="../collections/">Collections</a>
</li>

                        
                            
<li >
    <a href="../extending/">Extending</a>
</li>

                        
                            
<li class="active">
    <a href="./">Robo as Framework</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tasks <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../tasks/Base/">Base Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Filesystem/">FileSystem Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/File/">File Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Composer/">Composer Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Vcs/">VCS Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Development/">Development Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Assets/">Assets Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Archive/">Archive Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Remote/">SSH, Rsync Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Testing/">Testing Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Npm/">NPM Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Bower/">Bower Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Gulp/">Gulp Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/Docker/">Docker Tasks</a>
</li>

                        
                            
<li >
    <a href="../tasks/ApiGen/">ApiGen Tasks</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../changelog/">Releases</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../extending/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../tasks/Base/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/codegyre/robo/">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        
        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#robo-as-a-framework">Robo as a Framework</a></li>
        
            <li><a href="#creating-a-standalone-phar-with-robo">Creating a Standalone Phar with Robo</a></li>
        
            <li><a href="#using-multiple-robofiles-in-a-standalone-application">Using Multiple RoboFiles in a Standalone Application</a></li>
        
            <li><a href="#using-your-own-dependency-injection-container-with-robo-advanced">Using Your Own Dependency Injection Container with Robo (Advanced)</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="robo-as-a-framework">Robo as a Framework</h1>
<p>There are multiple ways to use and package Robo scripts; a few of the alternatives are presented below.</p>
<h2 id="creating-a-standalone-phar-with-robo">Creating a Standalone Phar with Robo</h2>
<p>It is possible to create a standalone phar that is implemented with Robo; doing this does not require the RoboFile to be located in the current working directory, or any particular location within your project. To achieve this, first set up your project as shown in the section <a href="../getting-started/#implementing-composer-scripts-with-robo">Implementing Composer Scripts with Robo</a>. Use of the "scripts" section is optional.</p>
<p>Next, add an "autoload" section to your composer.json to provide a namespace for your Robo commands:</p>
<pre><code>{
    &quot;name&quot;: &quot;myorg/myproject&quot;,
    &quot;require&quot;: {
        &quot;consolidation/Robo&quot;: &quot;~1&quot;
    },
    &quot;autoload&quot;:{
        &quot;psr-4&quot;:{
            &quot;MyProject\\&quot;:&quot;src&quot;
        }
    }
}
</code></pre>

<p>Create a new file for your Robo commands, e.g. <code>class RoboFile</code> in <code>namespace MyProject\Commands;</code> in the file <code>src\Commands\RoboFile.php</code>.  Optionally, add more task libraries as described in the <a href="../extending/">extending</a> document.</p>
<p>Create a startup script similar to the one below, and add it to the root of your project, or some other location of your choosing:</p>
<pre><code class="php">#!/usr/bin/env php
&lt;?php

/**
 * If we're running from phar load the phar autoload file.
 */
$pharPath = \Phar::running(true);
if ($pharPath) {
    require_once &quot;$pharPath/vendor/autoload.php&quot;;
} else {
    if (file_exists(__DIR__.'/vendor/autoload.php')) {
        require_once __DIR__.'/vendor/autoload.php';
    } elseif (file_exists(__DIR__.'/../../autoload.php')) {
        require_once __DIR__ . '/../../autoload.php';
    }
}

$commandClasses = [ \MyProject\Commands\RoboFile::class ];
$statusCode = Robo::run(
    $_SERVER['argv'], 
    $commandClasses, 
    'MyAppName', 
    '0.0.0-alpha0'
);
exit($statusCode);
</code></pre>

<p>When using Robo as a framework, the Robo file should be included in the autoloader, as Robo does not include a <code>RoboFile.php</code> file when used in this mode. Instead, specify the class or classes to load as a parameter to the Robo::run() method. By default, all output will be sent to a Symfony ConsoleOutput() that Robo will create for you. If you would like to use some other OutputInterface to capture the output, it may be specified via an optional fifth parameter.</p>
<p>Use <a href="https://github.com/box-project/box2">box-project/box2</a> to create a phar for your application.  Note that if you use Robo's taskPackPhar to create your phar, then <code>\Phar::running()</code> will always return an empty string due to a bug in this phar builder. If you encounter any problems with this, then hardcode the path to your autoload file.  See the <a href="https://github.com/consolidation-org/Robo/blob/master/robo">robo</a> script for details.</p>
<h2 id="using-multiple-robofiles-in-a-standalone-application">Using Multiple RoboFiles in a Standalone Application</h2>
<p>It is possible to provide as many command classes as you wish to the Robo <code>Runner()</code> constructor. You might wish to separate your Robo command implementations into separate Robo files if you have a lot of commands, or if you wish to group similar commands together in the same source file. If you do this, you can simply add more class references to the <code>$commandClasses</code> variable shown above.</p>
<pre><code>$commandClasses = [ 
    \MyProject\Commands\BuildCommands::class, 
    \MyProject\Commands\DeployCommands::class 
];
</code></pre>

<p>If your application has a large number of command files, or if it supports command extensions, then you might wish to use the Command Discovery class to locate your files. The <code>CommandFileDiscovery</code> class will use the Symfony Finder class to search for all filenames matching the provided search pattern. It will return a list of class names using the provided base namespace.</p>
<pre><code class="php">$discovery = new \Consolidation\AnnotatedCommand\CommandFileDiscovery();
$discovery-&gt;setSearchPattern('*Command.php');
$commandClasses = $discovery-&gt;discover('php/MyProject/Commands', '\MyProject\Commands');
</code></pre>

<p>Pass the resulting <code>$commandClasses</code> to the <code>Runner()</code> constructor as shown above.  See the annotated-commands project for more information about the different options that the discovery command takes.</p>
<h2 id="using-your-own-dependency-injection-container-with-robo-advanced">Using Your Own Dependency Injection Container with Robo (Advanced)</h2>
<p>It is also possible to completely replace the Robo application with your own.  To do this, set up your project as described in the sections above, but replace the Robo runner with your own main event loop.</p>
<p>Create the Robo dependency injection container:</p>
<pre><code>use League\Container\Container;

$input = new \Symfony\Component\Console\Input\ArgvInput($argv);
$output = new \Symfony\Component\Console\Output\ConsoleOutput();
$conf = new \Robo\Config(); \\ or use your own subclass
$app = new \My\Application();
$container = \Robo\Robo::createDefaultContainer($input, $output, $app, $conf);
</code></pre>

<p>If you are using League\Container (recommended), then you may simply add and share your own classes to the same container.  If you are using some other DI container, then you should use <a href="https://github.com/container-interop/fig-standards/blob/master/proposed/container.md#14-additional-feature-delegate-lookup">delegate lookup</a> to combine them.</p></div>
            

        </div>
        

        <footer class="col-md-12">
            <div >

                <p>Robo is product of <a href="http://codegyre.com">Codegyre</a>. 

</p>
<p>
    Robo is on <a href="http://twitter.com/robo_php">Twitter</a> and on <a href="https://github.com/codegyre/robo">GitHub</a>
</p>
                
                <p>
                    See also:
                    <a href="http://codeception.com">Codeception</a> |
                    <a href="https://github.com/Codeception/AspectMock">AspectMock</a> |
                    <a href="http://phptest.club">PHP Test Club</a>
                </p>
            </div>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
         <div class="modal-dialog">
             <div class="modal-content">
                 <div class="modal-header">
                     <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                     <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                 </div>
                 <div class="modal-body">
                     <p>
                         From here you can search these documents. Enter
                         your search terms below.
                     </p>
                     <form role="form">
                         <div class="form-group">
                             <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                         </div>
                     </form>
                     <div id="mkdocs-search-results"></div>
                 </div>
                 <div class="modal-footer">
                 </div>
             </div>
         </div>
     </div>
    </body>
</html>